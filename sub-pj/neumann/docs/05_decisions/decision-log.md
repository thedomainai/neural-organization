# Decision Log

重要な意思決定を記録する（ADR: Architecture Decision Record形式）。

## 意思決定一覧

| ID | タイトル | 日付 | ステータス |
|----|----------|------|----------|
| DEC-001 | プロジェクト名の決定 | 2026-01-10 | ✅ 承認済 |
| DEC-002 | ターゲット市場の拡大 | 2026-01-10 | ✅ 承認済 |
| DEC-003 | 大企業でもAutonomous Interventionを維持 | 2026-01-10 | ✅ 承認済 |
| DEC-004 | srcディレクトリ構成とアーキテクチャ方針 | 2026-01-13 | ✅ 承認済 |
| DEC-005 | vercel-stackベースへのアーキテクチャ移行 | 2026-01-22 | ✅ 承認済 |
| DEC-006 | 仮説検証の優先順位 | 2026-01-22 | ✅ 承認済 |
| DEC-007 | 曖昧性検出パターン仕様 | 2026-01-23 | ✅ 承認済 |

---

## DEC-001: プロジェクト名の決定

**日付**: 2026-01-10
**ステータス**: ✅ 承認済
**決定者**: Human

### コンテキスト

AGI時代の経営管理プロダクトAgentを開発するプロジェクトの命名が必要。

### 検討した選択肢

1. **nash** - ジョン・ナッシュ（ゲーム理論）
2. **laplace** - ラプラス（確率論、ラプラスの悪魔）
3. **neumann** - フォン・ノイマン（ゲーム理論＋計算機科学）
4. **drucker** - ドラッカー（経営学）

### 決定

**neumann** を採用。

### 理由

- ゲーム理論（経営戦略）と計算機科学（AI）の両方を確立した人物
- 経営×AGIというプロダクトの本質を象徴
- 既存プロジェクトの命名パターン（物理学者名）との一貫性

### 影響

- プロジェクトディレクトリ名: `neumann/`
- 将来のプロダクト名の候補

---

## DEC-002: ターゲット市場の拡大

**日付**: 2026-01-10
**ステータス**: ✅ 承認済
**決定者**: Human

### コンテキスト

当初ターゲットは「シリーズA-B（30-100名）」と定義していたが、より大きな市場機会の検討が必要。

### 検討した選択肢

1. **シリーズA-Bに集中** - PMF達成後にスケール
2. **時価総額100億〜1兆円まで拡大** - 初期から大企業も視野に

### 決定

**時価総額100億〜1兆円まで拡大**。シリーズA-Bから時価総額1兆円の企業までをターゲットとする。

### 理由

- 課題（Black Box Anxiety）は組織が大きくなるほど深刻化する
- 大企業を獲得することで権威性と売上の両方を獲得できる
- COO代替としてのROIは大企業ほど大きい（年収3000万〜1億の代替）

### リスク

- 大企業は営業サイクルが長く、フィードバックループが遅い
- 導入の意思決定が複雑（情シス、法務、経営企画の承認）
- 既存システム（SAP、Oracle等）との統合要求

### 影響

- personas.md のターゲット定義を更新
- 市場規模推定の範囲を拡大
- GTM戦略で大企業向けアプローチを検討

---

## DEC-003: 大企業でもAutonomous Interventionを維持

**日付**: 2026-01-10
**ステータス**: ✅ 承認済
**決定者**: Human

### コンテキスト

大企業をターゲットに含めた場合、「AIが許可を待たずに介入する」というAutonomous Interventionの原則を維持できるか？大企業ではガバナンス上の制約が大きい。

### 検討した選択肢

1. **維持する** - neumannのコア思想を貫く
2. **大企業向けには緩和する** - 介入範囲を設定可能にする
3. **大企業向けは別プロダクトにする** - 思想の異なる別ラインを作る

### 決定

**維持する**。企業規模に関わらずAutonomous Interventionを維持。

### 理由

- Autonomous Interventionはneumannのコア思想であり、ここを緩めるとプロダクトの価値が薄まる
- 「設定可能」にすると、結局オフにされて使われない機能になるリスク
- AI介入を許容できない企業はアンチペルソナとして除外

### リスク

- Autonomous Interventionを許容できる大企業が限定的である可能性
- 「機能としては良いが導入できない」という評価になるリスク

### 影響

- アンチペルソナの定義を「Legacy Enterprise」から「AI介入拒否組織」に変更（規模ではなく許容度で判断）
- 大企業向け営業では「Autonomous Intervention」の価値を説明するメッセージングが必要

---

## DEC-004: srcディレクトリ構成とアーキテクチャ方針

**日付**: 2026-01-13
**ステータス**: ✅ 承認済
**決定者**: 協働

### コンテキスト

neumannのsrcディレクトリ構成を決定する必要がある。特に、将来的なAgentic AI / AI Orchestration層の追加可能性を考慮しつつ、MVPを早期にリリースしたいという要件がある。

### 検討した選択肢

1. **A案: Webアプリ中心（シンプル構成）**
   - Next.js Webアプリ内でLLM API呼び出し
   - 「自律介入」はcron job / webhookで実現
   - 開発速度が速い（2週間程度でMVP）

2. **B案: Webアプリ + Agentic AIバックエンド（分離構成）**
   - WebアプリはUI専用
   - 別途Orchestrator層（Python）が常駐
   - 複数の専門Agentが協調
   - 開発に4-6週間

### 決定

**A案を採用し、後からB案に進化可能な設計とする**。

具体的には：
- ドメインロジック（曖昧性検出）を `domain/` 層として分離
- UI/Reactに依存しない純粋関数として実装
- これにより、後からOrchestrator層を「追加」する際に「作り直し」ではなく「移植」で済む

### 理由

1. **MVP検証の目的**: 最重要仮説「CEO Acceptance」の検証に、本物のProactive介入は必須ではない
2. **時間優先**: 早期リリースで仮説検証を回したい
3. **作り直しコストの軽減**: 適切な設計（domain層分離）により、後からの追加が容易
4. **Agentic AIへの憧れバイアスの排除**: 技術的魅力ではなく、検証に必要な最小構成を選択

### 影響

- `02_product/architecture.md` にsrcディレクトリ構成を記載
- Phase 1（MVP）はA案構成で開発
- 検証成功後、Phase 2でOrchestrator層を追加検討
- `domain/` 層の設計はReact/Next.jsに依存しないこと（移植性確保）

---

## DEC-005: vercel-stackベースへのアーキテクチャ移行

**日付**: 2026-01-22
**ステータス**: ✅ 承認済
**決定者**: Human

### コンテキスト

neumann の技術スタックが古くなっており（Next.js 14, NextAuth.js, Zustand）、本番運用品質に達していない。vercel-stack というモダンスターターを参考に再設計する提案があった。

### 検討した選択肢

1. **現アーキテクチャを維持・改善** - NextAuth.js, Zustand を維持
2. **vercel-stackベースで再構築** - Supabase Auth/DB, Server Actions へ移行
3. **ハイブリッド** - 一部の技術のみ変更

### 決定

**vercel-stackベースで再構築**。

### 理由

- 本番運用品質（テスト、CI/CD、監視）を初期から組み込み
- Supabase による Auth + DB + Storage の統合
- Server Components / Server Actions による状態管理の簡素化
- Coding Agent（Claude Code）が理解しやすい構造

### 影響

- `02_product/architecture.md` を v2 として更新
- 既存の `domain/` 層の型定義はそのまま活用可能
- UIコンポーネントは shadcn/ui で再構築

---

## DEC-006: 仮説検証の優先順位

**日付**: 2026-01-22
**ステータス**: ✅ 承認済
**決定者**: Human

### コンテキスト

Phase 1 で検証すべき仮説の優先順位を決定する必要がある。

### 検討した選択肢

1. **CEO受容性（Bad Cop Acceptance）を優先** - プロダクトの根幹
2. **曖昧性検出精度を優先** - 技術的な実現可能性

### 決定

**曖昧性検出精度を優先**。

### 理由

- LLMが曖昧性を高精度で検出できなければ、プロダクト価値が成立しない
- 技術的な実現可能性を先に確認することで、CEO検証の準備が整う
- 検出精度のPoCは比較的短期間で実施可能

### 影響

- Phase 1-B（技術検証）を先行
- Fact/Interpretation分離PoC、再帰的分解シミュレーションを実施
- CEO受容性検証は検出精度が確認できた後に実施

---

## DEC-007: 曖昧性検出パターン仕様

**日付**: 2026-01-23
**ステータス**: ✅ 承認済
**決定者**: Human

### コンテキスト

neumannのコア機能である「曖昧性検出」について、検出パターンの詳細仕様を定義する必要があった。PoC検証を実施するためには、何を検出するかの基準が必要。

### 決定

5つの曖昧性パターンを定義:

| コード | パターン名 | 検出難易度 |
|--------|-----------|-----------|
| FI | Fact/Interpretation Mixing | Medium |
| LQ | Lack of Quantification | Easy |
| UA | Unclear Action | Easy |
| SA | Shallow Analysis | Hard |
| MC | Missing Coverage | Hard |

重要度分類:
- **Critical**: 意思決定を誤らせる可能性（5点減点）
- **Warning**: 改善が望ましい（2点減点）
- **Info**: 可能なら改善（1点減点）

品質スコア計算式:
```
Quality Score = 100 - (Critical×5 + Warning×2 + Info×1)
```

検出精度目標:
- PoC: Precision 80%, Recall 70%
- MVP: Precision 85%, Recall 80%

### 理由

- 5パターンは `01_concept/solution.md` の5原則に対応
- 重要度の重み付けは、意思決定への影響度を基準
- 精度目標は、実用上の許容範囲を考慮

### 影響

- `02_product/features/audit-patterns.md` に詳細仕様を記載
- `03_validation/experiments/poc-data/` にサンプルデータを作成
- PoC検証の評価基準として使用

---

## テンプレート

```markdown
## DEC-XXX: タイトル

**日付**: YYYY-MM-DD
**ステータス**: 🟡 提案中 / ✅ 承認済 / ❌ 却下 / 🔄 置換済
**決定者**: Human / 協働

### コンテキスト
なぜこの決定が必要になったか

### 検討した選択肢
1. 選択肢A
2. 選択肢B
3. 選択肢C

### 決定
選んだ選択肢

### 理由
なぜその選択をしたか

### 影響
この決定による影響範囲
```
