# Ambiguity Detection Patterns Specification

**Feature ID**: F-001
**Related Stories**: US-001, US-002
**Status**: ✅ 承認済 (DEC-007)
**Version**: 1.0.0
**Last Updated**: 2026-01-23

---

## 概要

neumannが週次レポートから検出する「曖昧性パターン」の仕様定義。
LLMによる自動検出とHumanによるレビューの両方で使用される共通基準。

---

## パターン一覧

| ID | コード | 名称 | 検出難易度 |
|----|--------|------|------------|
| P1 | `FI` | Fact/Interpretation Mixing | Medium |
| P2 | `LQ` | Lack of Quantification | Easy |
| P3 | `UA` | Unclear Action | Easy |
| P4 | `SA` | Shallow Analysis | Hard |
| P5 | `MC` | Missing Coverage | Hard |

---

## P1: Fact/Interpretation Mixing (`FI`)

### 定義

**事実と解釈が混在または分離されていない記述**

客観的事実（誰が見ても同じ）と主観的解釈（報告者の判断）が区別なく記述されている状態。

### 検出トリガー

以下のいずれかに該当する場合:

1. **評価語の単独使用**
   - 「良好」「順調」「問題あり」「期待できる」などの形容詞が、具体的事実なしに使用

2. **不明確な引用**
   - 「〜というコメントをいただいた」「前向きな反応」など、発言者・内容が不明確

3. **根拠なき推測**
   - 「〜だと思う」「〜かもしれない」が、支持するデータなしに記述

### 検出ルール

```
IF text contains [評価語]
   AND NOT followed_by [具体的事実/数値/引用]
THEN flag as FI
```

**評価語リスト**（部分）:
- ポジティブ: 良好、順調、好調、期待できる、前向き、改善、進捗
- ネガティブ: 問題、懸念、課題、悪化、停滞、遅延
- 程度: やや、少し、かなり、非常に、多い、少ない

### 重要度分類

| Severity | 条件 | 例 |
|----------|------|-----|
| Critical | 意思決定に影響する評価語 | 「受注確度は高い」（根拠なし） |
| Warning | 状況報告での評価語 | 「反応は概ね良好」 |
| Info | 軽微な修飾 | 「少し改善した」 |

### Before/After 例

**Before (FI)**:
> 反応は概ね良好で、先方の部長クラスからは前向きなコメントをいただきました。

**After (Clear)**:
> CIO佐々木氏発言:「API連携の柔軟性は高く評価できる」
> 情シス部長田中氏発言:「セキュリティ面の懸念はクリアされた」

---

## P2: Lack of Quantification (`LQ`)

### 定義

**数値化可能な事項が定量化されていない記述**

測定可能な指標が「多い」「少ない」「増加」「減少」などの定性的表現のみで記述されている状態。

### 検出トリガー

以下のいずれかに該当する場合:

1. **定性的増減表現**
   - 「増加した」「減少した」「改善した」「悪化した」が数値なし

2. **曖昧な程度表現**
   - 「やや」「少し」「かなり」「非常に」が数値の代わりに使用

3. **比較対象なき比較**
   - 「先週より」「前月比」と言いながら具体的数値がない

4. **KPI報告での数値欠如**
   - 目標値、実績値、達成率のいずれかが欠けている

### 検出ルール

```
IF text contains [数量関連キーワード]
   AND NOT contains [数値表現]
THEN flag as LQ
```

**数量関連キーワード**:
- 増減: 増加、減少、上昇、下降、改善、悪化、成長、縮小
- 程度: やや、少し、かなり、非常に、多い、少ない、大幅
- 比較: 先週比、前月比、昨年比、目標比、予定比
- KPI名詞: 売上、利益、件数、率、人数、時間

### 重要度分類

| Severity | 条件 | 例 |
|----------|------|-----|
| Critical | KPI/財務数値の欠如 | 「売上は増加傾向」 |
| Warning | 比較・達成度の欠如 | 「目標比でやや未達」 |
| Info | 軽微な数量表現 | 「いくつかの案件」 |

### Before/After 例

**Before (LQ)**:
> SDRのアポ獲得: 目標比でやや未達

**After (Clear)**:
> SDRアポ獲得: 18件 / 目標25件 = 達成率72%（先週比+3件）

---

## P3: Unclear Action (`UA`)

### 定義

**Who/What/When が不明確なアクション記述**

次のアクションとして記載されているが、担当者・期限・完了基準のいずれかが欠けている状態。

### 検出トリガー

以下のいずれかに該当する場合:

1. **担当者不明**
   - アクションに対して誰が実行するか記載がない

2. **期限不明**
   - 「来週」「近いうちに」「今後」など具体的日付がない

3. **完了基準不明**
   - 何をもって完了とするかの定義がない
   - 「フォローアップ」「対応」「検討」など曖昧な動詞のみ

### 検出ルール

```
IF section is [来週のアクション] OR [Next Steps]
   AND action_item lacks [担当者] OR [期限] OR [完了基準]
THEN flag as UA
```

**曖昧動詞リスト**:
- 対応する、フォローする、検討する、確認する、調整する
- 進める、推進する、強化する、改善する
- 〜していく、〜に取り組む

### 重要度分類

| Severity | 条件 | 例 |
|----------|------|-----|
| Critical | 3要素すべて欠如 | 「A社フォローアップ」 |
| Warning | 1-2要素欠如 | 「来週、A社に連絡」（担当・完了基準なし） |
| Info | 完了基準のみ欠如 | 「山田が10/25までにA社へ連絡」 |

### Before/After 例

**Before (UA)**:
> - A社フォローアップ
> - B社、C社の提案準備
> - 採用面接（2名予定）

**After (Clear)**:
> | アクション | 担当 | 期限 | 完了基準 |
> |-----------|------|------|----------|
> | A社技術質問回答書送付 | 渡辺 | 10/24 | CTO確認済み回答書を田中部長へメール |
> | B社提案書最終化 | 佐藤 | 10/23 | 先方要望反映の最終版完成 |
> | 採用面接実施 | 山田 | 10/24-25 | 2名面接完了、推薦可否決定 |

---

## P4: Shallow Analysis (`SA`)

### 定義

**原因分析が表層で止まっている記述**

問題・課題に対して「なぜ」が十分に深掘りされておらず、根本原因に到達していない状態。

### 検出トリガー

以下のいずれかに該当する場合:

1. **Why の欠如**
   - 問題を記述しているが、原因への言及がない

2. **単一原因帰属**
   - 複合的な問題に対して単一の原因のみ記載

3. **外部要因への帰属のみ**
   - 「先方の都合」「市場環境」など外部要因のみで、内部要因の検討がない

4. **対策と原因の不整合**
   - 記載された対策が、原因に対応していない

### 検出ルール

```
IF section contains [問題/課題/懸念]
   AND (
     NOT followed_by [原因/要因/理由]
     OR cause_count < 2
     OR all_causes are [外部要因]
   )
THEN flag as SA
```

**外部要因キーワード**:
- 先方の、顧客の、市場の、競合の、環境の
- 〜の都合、〜の事情、〜の影響

### 重要度分類

| Severity | 条件 | 例 |
|----------|------|-----|
| Critical | 重大問題に原因分析なし | 「解約が発生。残念だった」 |
| Warning | 原因が浅い/単一 | 「遅延は先方の社内調整のため」 |
| Info | 分析はあるが不完全 | 原因2つ記載（3つ以上望ましい） |

### Before/After 例

**Before (SA)**:
> A社は当初9月クローズ予定でしたが、先方の社内調整に時間がかかっている状況です。

**After (Clear)**:
> **A社遅延の根本原因分析**:
> - 当初は部長決裁案件と想定（予算800万円）
> - 提案過程で追加要件が発生し、年間3,000万円規模に拡大
> - 金額増加により役員会承認が必要になった（7月時点で判明）
> - 内部要因: 初期ヒアリング時のスコープ確認が不十分だった

---

## P5: Missing Coverage (`MC`)

### 定義

**報告対象に漏れがある記述**

報告すべき項目の一部が省略されている、またはMECE（Mutually Exclusive, Collectively Exhaustive）でない状態。

### 検出トリガー

以下のいずれかに該当する場合:

1. **「〜など」による省略**
   - 「A社、B社など」のように、残りが不明

2. **部分報告**
   - 「いくつかの」「一部の」で全体像が不明

3. **例外の未言及**
   - 成功事例のみで失敗事例がない、またはその逆

4. **定義済み項目の欠如**
   - 報告フォーマット上存在すべき項目が記載されていない

### 検出ルール

```
IF text contains [省略表現]
   OR report lacks [必須セクション]
   OR coverage_ratio < threshold
THEN flag as MC
```

**省略表現**:
- 〜など、〜等、その他、いくつか、一部、主な

### 重要度分類

| Severity | 条件 | 例 |
|----------|------|-----|
| Critical | 重要項目の欠如 | 赤アカウント5社のうち2社のみ報告 |
| Warning | 「など」で省略 | 「A社、B社などが好調」 |
| Info | 軽微な省略 | 背景情報の一部省略 |

### Before/After 例

**Before (MC)**:
> ヘルススコア「赤」のアカウントについては、来週から集中的にケアしていく予定です。特にF社とG社は要注意です。

**After (Clear)**:
> **ヘルススコア「赤」アカウント状況（全5社）**:
> | 会社 | 状況 | 今週アクション | 来週予定 |
> |------|------|---------------|---------|
> | F社 | 担当者異動 | 訪問実施 | 再トレーニング |
> | G社 | 機能活用率低 | 分析完了 | ウェビナー企画 |
> | L社 | 未把握 | なし | 状況確認 |
> | M社 | 未把握 | なし | 状況確認 |
> | N社 | 予算削減 | メール | 継続フォロー |

---

## 重要度（Severity）の定義

### Critical（重大）

**即座の対応が必要**

- 意思決定を誤らせる可能性がある
- 重大なリスクを隠蔽している可能性がある
- 経営判断に必要な情報が欠落している

### Warning（警告）

**改善が望ましい**

- 詳細を知りたい場合に追加質問が必要
- レポートの信頼性を下げる
- 蓄積すると問題化する

### Info（情報）

**可能なら改善**

- 軽微な曖昧さ
- 文脈から推測可能
- 次回から改善すればよい

---

## 品質スコア計算

### 計算式

```
Quality Score = 100 - (Critical × 5 + Warning × 2 + Info × 1)
```

### スコア解釈

| スコア | 評価 | アクション |
|--------|------|-----------|
| 90-100 | Excellent | 承認可 |
| 70-89 | Good | 軽微な修正推奨 |
| 50-69 | Needs Improvement | 修正必須 |
| 0-49 | Poor | 再提出要求 |

---

## 検出精度目標

### PoC Phase（Phase 1）

| Metric | Target | 許容範囲 |
|--------|--------|---------|
| Precision | 80% | 75-85% |
| Recall | 70% | 65-75% |
| F1 Score | 0.75 | 0.70-0.80 |

### MVP Phase（Phase 2）

| Metric | Target | 許容範囲 |
|--------|--------|---------|
| Precision | 85% | 80-90% |
| Recall | 80% | 75-85% |
| F1 Score | 0.82 | 0.77-0.87 |

### 許容する誤差

- Severity の1段階ずれは許容（Critical↔Warning、Warning↔Info）
- 隣接パターンの混同は許容（SA↔LQ の境界ケース等）
- 同一箇所への複数パターン検出は正解とみなす

---

## 検出プロンプト設計指針

### 入力構造

```
<context>
会社情報、組織構造、KPI定義
</context>

<report>
週次レポート本文
</report>

<patterns>
パターン定義（本ドキュメントの内容）
</patterns>

<task>
レポートを分析し、曖昧性パターンを検出してください。
各検出項目について以下を出力:
- 該当箇所（引用）
- パターンコード
- 重要度
- 問題点
- 改善案
</task>
```

### 出力構造

```json
{
  "report_id": "string",
  "quality_score": number,
  "issues": [
    {
      "id": "string",
      "pattern": "FI|LQ|UA|SA|MC",
      "severity": "critical|warning|info",
      "location": "string (quoted text)",
      "issue": "string (explanation)",
      "suggestion": "string (improved version)"
    }
  ],
  "summary": {
    "total_issues": number,
    "by_pattern": { "FI": n, "LQ": n, ... },
    "by_severity": { "critical": n, "warning": n, "info": n }
  }
}
```

---

## Human承認待ち項目

本仕様について以下の確認・承認を依頼:

1. **パターン定義の妥当性**
   - 5パターンで十分か、追加すべきパターンはあるか
   - 各パターンの定義は明確か

2. **重要度分類基準**
   - Critical/Warning/Info の境界は適切か
   - スコア計算の重み付けは妥当か

3. **検出精度目標**
   - PoC/MVPの目標値は現実的か
   - 許容誤差の範囲は適切か

4. **検出ルールの詳細**
   - キーワードリストの追加・削除
   - 業界・組織特有の表現の考慮

---

**オーナー**: AI（Human承認待ち）
**関連ドキュメント**:
- `03_validation/experiments/poc-data/02_reports_annotated.md`
- `02_product/features/mvp-spec.md`（未作成）
